---
title: "Linstat-strikk"
author: "Ellisiv"
date: "31 mars 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Introduction

 * Description
 In this project we will have a look at different parameters affec ting the memory of a person. The person will get a list of numbers, and the aim is to remember as many of the numbers in a given time, in the right order. Then there will be a 15 seconds break, followed by her writing down the numbers with a time limit of 20 seconds. The response variable is the the amount of numbers she can remember, where the last number that is right is the response. The factors that will vary are the time she gets to look at the numbers, 30 seconds and one minute, wheter she can use any aids while memorizing, if there are any distrubances during the break and wheter she is using shoes or not. 

 * What is interesting, what do we know in advance, what do we want to achieve?
 Memory is an interresting topic, and highly relevant for students. Also, it could be an advantage for the test person to know how she memorizes best. Noen som har noe mer å skrive her??
 We think that the time you get to memorize the numbers and wheter you get to use aids or not, will be important factors. We also expect the consentration to weaken durint the test/forsøk/hva kaller vi det??. Therefor the order of the different factors should be random, and preferably in different orders in the two blocks. Also, we used two diffrent persons in the two blocks, and would therefor expect them to be (annerledes??? at de har noe å si på modellen, hvordan sier man det?)
 We want to see if our assumptions coincide with our findings. 
 
 

# Set-up

```{r design, include=T}
#install.packages('FrF2')
library(FrF2)

plan <- FrF2(nruns = 32, nfactors=5, randomize = F)
#ykast <- c(2.22, 4.50, 2.88, 4.07, 2.30, 2.34, 2.00, 2.47, 2.60, 1.60, 3.98, 3.38, 2.82, 2.61, 1.88, 3.20, 2.63, 2.22, 3.38, 6.00, 4.06, 1.53, 5.70, 5.30, 2.01, 1.82, 2.60, 7.0, 1.57, 3.20, 4.00, 2.49)

y <- c(9, 9, 9, 4, 6, 15, 6, 3, 11, 15, 12, 12, 5, 12, 6, 1, 9, 15, 9, 11, 12, 12, 6, 12, 12, 0, 9, 15, 7, 15, 6, 9)
plan <- add.response(plan, y)
#plan <- plan[, -4]
lm4 <- lm(y~(A + B + C + D)^2 + E, data=plan)
summary(lm4)
effects <- lm4$coeff*2
DanielPlot(lm4)
MEPlot(lm4)
IAPlot(lm4)
cubePlot(lm4,"A","B","C")

effects <- 2*lm4$coefficients[-1] # omit intercept
abseffects<-abs(effects)
medabseffects <- median(abseffects)
tauest <- 1.5*medabseffects
keepeffects <- abseffects[abseffects< 2.5*tauest]
taustar <- 1.5*median(keepeffects)
alpha<-0.05 # significance level
cutoff<-qt(1-alpha/2,length(abseffects)/3)*taustar
cutoff
effects 

sig <- which(abseffects>cutoff)
DanielPlot(lm4,autolab=FALSE,faclab=list(idx=sig,lab=(paste("   ",attr(lm4$terms,"term.labels"))[sig])))

rres <- rstudent(lm4)
plot(lm4$fitted,rres)

qqnorm(rres)
qqline(rres)
library(nortest)
ad.test(rstudent(lm4))

```


