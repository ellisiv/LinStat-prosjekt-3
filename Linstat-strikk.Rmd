---
title: "Linstat-strikk"
author: "Ellisiv"
date: "31 mars 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Introduction
  Memory is one of the most important features of the human brain. Without it humans would not be able to learn anything, and it is necessary for the daily functionality. 
  An important part of the memory is the short-term memory, which is the brains capacity to remeber a small amount of information for a small period of time. From before we know that the short-term memory has about the capacity to remember seven, plus or minus two, items at the same time. Our goal is to test wheter this holds or not. 



# Selection of factors and response  
  The first thing we tested was to memorize words. A list of wors was given to the test person, from which she tried to memorize as many words as possible. This was tested with different factors, and two different persons. Each time the number of words memorized, without exception, was six. Hence, we decided to give the same experiment a try, only exchanging worsd with digits. This resulted in a much higher variance than when we tried memorizing words. 
  The factors we think are relevant when testing the short term memory is the amount of time the test person gets to look at the digits, wheter the person is disturbed between memorizing and writing down the digits or not and wheter she is allowed to use aids, such as pen and paper, while looking at the digits. 
  We expect an interraction between time and aid, thinking that they will amplify each other. For each of the factors we think that two levels will be the most suitable, i.e. short and long time to look at the digits, disturbance or not between looking at the digits and writing the down and wheter she gets to use aids or not. One could argue for three levelsof time, but we believe that two levels will be suficient if one for example double the amount of time.
  Also, we think that it is easy to control that the factors are at the desired level since we can measure the time, choose to use aids or not and we can make sure of disturbance or not our self. 

  A response variable that will give the information we need is the number of digits the test person remembers in the right order until the first mistake, meaning that if the first digit is wrong, you get Y equal to zero, regardless of the correctness of the next digits. In theory the test person gets an infinite number of digits, but since time is limited, one can also limit the number of digits given, and still count it as infinite. One could also chose to get a finite number of digits or numbers, and count the amount that is in the right spot. There are also a lot of different variations one could do when counting the amount og numbers that the test person are able to memorize, the most important thing is that one are consistent. As mentioned, one could also count words instead of digits. The accuracy when using the first response variable is 100% since we easily can count how many digits there are until the first mistake. 
  



# Choice of design 
We choose a full $2^k$ factorial experiments with replicate because of the simple nature of the experiment. One full trial does not need complicated equipment and replication causes minimal resources. The only problem with doing multiple experiments is that the test person gets tired and it is hard to reset between rounds. Because of that we choose to use two different test people and do one full trial with both of them. The result is a $2^4$ factorial design with $2^5$ experiments. Because of the different test people it is necessary to divide the design into two blocks, one block representing a test person. This is needed because the memory of the test people can differ, so the block factor needs to compensate for this. 

# Experimental set-up
We chose the factors discussed above, but the value of the two levels needs to be determined and we need to choose some guidelines to make the experiments consistent. The two time intervals needs to be sufficiently different, but at the same time we do not want to have too long time intervals to cause as little as possible exhaustion for the test persons. We decide on the short interval, coded as $time = -1$, to be $30$sec and the long time interval, coded as $time = 1$, to be $60$sec. The aids provided is pen and paper and the possibility of speaking out loud. To not make this a writing contest the paper is taken away from the test person after the time for memorizing is up. To make the task a bit more challenging the test people get 15 seconds break between momorizing and writing down their final answer. This time is constant and is thus not a factor in our trials. It is also in this period the person could be disturbed. After some discussion we choose that there should just be loud talking in the background which needs no respons from the test person, or else it would be too hard to remember anything.  
To explore the quality of our experiments, we include a variable which we assume will have no effect on the result, which is if the test person is wearing shoes. Because we do a limited amount of experiments it is interessting to see if the random variable will be included in the final model we choose.  
There are several challenges when measuring the response variable. It is not trivial to measure the quality of an answer, what if the first digits are wrong, but others are rightly placed? And what if a digit is excluded and that shifts the order of the rest of the answer? To make the rules simple and consistent, we then decided the response, $y$, to be the number of digits rightly guessed up to the first mistake. 

# Experimental weaknesses



We randomize the order of experiments in a trial to eliminate time as a decisive factor and we do not have the same order of experiments for our two trials. It was not a problem sticking to the randomized order, but we differed one time because of an error when reading the randomized design matrix. Anyhow, this does not cause any trouble because of the random order and the switch of order was done completely at random.   
Nevertheless the nature of our experiments lead to some unexpected behaviour. 

# Set-up

```{r design, include=T}
#install.packages('FrF2')
library(FrF2)

plan <- FrF2(nruns = 32, nfactors=5, randomize = F)
#ykast <- c(2.22, 4.50, 2.88, 4.07, 2.30, 2.34, 2.00, 2.47, 2.60, 1.60, 3.98, 3.38, 2.82, 2.61, 1.88, 3.20, 2.63, 2.22, 3.38, 6.00, 4.06, 1.53, 5.70, 5.30, 2.01, 1.82, 2.60, 7.0, 1.57, 3.20, 4.00, 2.49)

y <- c(9, 9, 9, 4, 6, 15, 6, 3, 11, 15, 12, 12, 5, 12, 6, 1, 9, 15, 9, 11, 12, 12, 6, 12, 12, 0.01, 9, 15, 7, 15, 6, 9)
plan <- add.response(plan, y)
#plan <- plan[, -4]
lm4 <- lm(y~(A + B + C + D)^4 + E, data=plan)
summary(lm4)
effects <- lm4$coeff*2
DanielPlot(lm4)
MEPlot(lm4)
#IAPlot(lm4)
cubePlot(lm4,"A","B","C")

effects <- 2*lm4$coefficients[-1] # omit intercept
abseffects<-abs(effects)
medabseffects <- median(abseffects)
tauest <- 1.5*medabseffects
keepeffects <- abseffects[abseffects< 2.5*tauest]
taustar <- 1.5*median(keepeffects)
alpha<-0.05 # significance level
cutoff<-qt(1-alpha/2,length(abseffects)/3)*taustar
cutoff
effects 

sig <- which(abseffects>cutoff)
DanielPlot(lm4,autolab=FALSE,faclab=list(idx=sig,lab=(paste("   ",attr(lm4$terms,"term.labels"))[sig])))

rres <- rstudent(lm4)
plot(lm4$fitted,rres)

qqnorm(rres)
qqline(rres)
library(nortest)
ad.test(rstudent(lm4))

```

```{r}
library(leaps)
allsubs <- regsubsets(y~(A + B + C + D)^4 + E, data = plan , nvmax = 16)
allsummary <- summary(allsubs)
allsummary$outmat

plot(allsummary$bic)
allsummary$bic

which.min(allsummary$bic)

plot(allsubs, scale = "bic")
plot(allsummary$adjr2)
allsummary$adjr2

which.max(allsummary$adjr2)

plot(allsubs, scale = "adjr2")

```

